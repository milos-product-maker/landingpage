<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lucid Computing | Configure Hardware</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap"
        rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['Space Mono', 'monospace'],
                    },
                    colors: {
                        lucid: {
                            50: '#f9fafb',
                            100: '#f3f4f6',
                            200: '#e5e7eb',
                            300: '#d1d5db',
                            500: '#6b7280',
                            600: '#4b5563',
                            800: '#1f2937',
                            900: '#111827',
                            accent: '#7c3aed', // Technical Purple
                            success: '#059669', // Verified Green
                            warning: '#d97706',
                        },
                        paper: '#fdfbf7',
                    }
                }
            }
        }
    </script>
    <style>
        body {
            background-color: #fdfbf7;
            color: #1f2937;
        }

        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            font-family: 'Space Mono', monospace;
        }

        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }

        .terminal-scroll::-webkit-scrollbar {
            width: 8px;
        }

        .terminal-scroll::-webkit-scrollbar-track {
            background: #1f2937;
        }

        .terminal-scroll::-webkit-scrollbar-thumb {
            background: #4b5563;
            border-radius: 4px;
        }

        .step-active {
            border-left-color: #7c3aed;
            background-color: #f3e8ff;
        }

        /* Animations */
        @keyframes pulse-slow {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.5;
            }
        }

        .animate-pulse-slow {
            animation: pulse-slow 3s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }

        .animate-fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>

<body class="font-sans antialiased">

    <nav class="border-b border-gray-200 bg-white/50 backdrop-blur-md sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center gap-3">
                    <a href="../index.html" class="flex items-center gap-3">
                        <div
                            class="w-8 h-8 bg-lucid-900 rounded-lg flex items-center justify-center text-white font-mono font-bold">
                            L</div>
                        <span class="font-bold text-xl tracking-tight text-lucid-900">Lucid Computing <span
                                class="font-normal text-lucid-500">Docs</span></span>
                    </a>
                </div>
                <div class="flex items-center gap-6 text-sm font-medium text-gray-600">
                    <a href="verification-tutorial.html" class="hover:text-lucid-accent transition-colors">Verification
                        Tutorial</a>
                    <a href="configure-hardware.html" class="text-lucid-accent font-semibold">Configure Hardware</a>
                    <button
                        class="bg-lucid-900 text-white px-4 py-2 rounded-md hover:bg-lucid-800 transition-colors">Log
                        In</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Header Section -->
    <header class="bg-paper py-20 border-b border-gray-100">
        <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <div
                class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-lucid-102 border border-purple-100 text-lucid-accent text-xs font-bold mb-6">
                <span class="relative flex h-2 w-2">
                    <span
                        class="animate-ping absolute inline-flex h-full w-full rounded-full bg-purple-400 opacity-75"></span>
                    <span class="relative inline-flex rounded-full h-2 w-2 bg-purple-500"></span>
                </span>
                VERIFIABLE TRAINING PROTOCOL V2.1
            </div>
            <h1 class="text-4xl md:text-5xl font-bold text-lucid-900 mb-6 tracking-tight">
                Configure Hardware <span class="text-lucid-accent">Playbook</span>
            </h1>
            <p class="text-lg text-gray-600 mb-10 leading-relaxed max-w-3xl mx-auto">
                Establish a mathematical chain of trust from raw silicon to trained model weights.
                This guide walks through the physical and logical verification of a 1,024-node GPU cluster.
            </p>

            <!-- Prerequisite Info Box -->
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4">
                <div class="flex items-start gap-2">
                    <div class="text-blue-600 text-xl">ⓘ</div>
                    <div>
                        <h4 class="font-semibold text-blue-900 text-sm mb-1">Prerequisites</h4>
                        <p class="text-xs text-blue-800 leading-relaxed">
                            This tutorial presupposes that your datacenter is already retrofitted with a
                            <strong>Lucid Computing Certified DC-SCM</strong> and <strong>smartNIC</strong> for each
                            node.
                        </p>
                    </div>
                </div>
            </div>
            <div class="flex gap-4 justify-center">
                <button onclick="scrollToGuide()"
                    class="bg-lucid-900 text-white px-6 py-3 rounded-lg font-semibold hover:bg-lucid-800 transition-all shadow-lg shadow-gray-200 flex items-center gap-2">
                    Start Integration
                    <span class="font-mono text-xs opacity-70">-></span>
                </button>
                <a href="#pillars"
                    class="bg-white border border-gray-300 text-gray-700 px-6 py-3 rounded-lg font-semibold hover:bg-gray-50 transition-all flex items-center gap-2">
                    Read the Research
                </a>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pb-24" id="guide-section">

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8 lg:gap-12 mt-12">

            <div class="lg:col-span-4 space-y-4">

                <div id="step-1-trigger"
                    class="step-card group cursor-pointer border-l-4 p-5 rounded-r-lg transition-all duration-300 step-active"
                    onclick="activateStep(1)">
                    <h3 class="font-semibold text-base text-lucid-900 mb-1 flex items-center gap-2">
                        <span
                            class="w-5 h-5 rounded-full bg-gray-200 text-gray-600 text-[10px] flex items-center justify-center font-bold">1</span>
                        Step 1: Install CLI
                    </h3>
                    <p class="text-xs text-gray-600 leading-relaxed">
                        Install the Lucid CLI and verify the "Step 0" retrofit. Confirm DC-SCM and smartNIC
                        installation.
                    </p>
                </div>

                <div id="step-2-trigger"
                    class="step-card group cursor-pointer border-l-4 border-transparent hover:bg-gray-50 p-5 rounded-r-lg transition-all duration-300"
                    onclick="activateStep(2)">
                    <h3 class="font-semibold text-base text-lucid-900 mb-1 flex items-center gap-2">
                        <span
                            class="w-5 h-5 rounded-full bg-gray-200 text-gray-600 text-[10px] flex items-center justify-center font-bold">2</span>
                        Step 2: Hardware Scan
                    </h3>
                    <p class="text-xs text-gray-600 leading-relaxed">
                        Discover all nodes and verify physical rack placement. Detect anomalies in cabling or asset
                        location immediately.
                    </p>
                </div>

                <div id="step-3-trigger"
                    class="step-card group cursor-pointer border-l-4 border-transparent hover:bg-gray-50 p-5 rounded-r-lg transition-all duration-300"
                    onclick="activateStep(3)">
                    <h3 class="font-semibold text-base text-lucid-900 mb-1 flex items-center gap-2">
                        <span
                            class="w-5 h-5 rounded-full bg-gray-200 text-gray-600 text-[10px] flex items-center justify-center font-bold">3</span>
                        Step 3: Hardware Doctor
                    </h3>
                    <p class="text-xs text-gray-600 leading-relaxed">
                        Verify TEE hardware & configuration for a specific GPU. Orchestrate secure enclave configuration
                        if discordant.
                    </p>
                </div>

                <div id="step-4-trigger"
                    class="step-card group cursor-pointer border-l-4 border-transparent hover:bg-gray-50 p-5 rounded-r-lg transition-all duration-300"
                    onclick="activateStep(4)">
                    <h3 class="font-semibold text-base text-lucid-900 mb-1 flex items-center gap-2">
                        <span
                            class="w-5 h-5 rounded-full bg-gray-200 text-gray-600 text-[10px] flex items-center justify-center font-bold">4</span>
                        Step 4: Hardware Integrity
                    </h3>
                    <p class="text-xs text-gray-600 leading-relaxed">
                        The "Hardware Truth". Caliptra Root-of-Trust and SPDM attestation of all firmware.
                    </p>
                </div>

                <div id="step-5-trigger"
                    class="step-card group cursor-pointer border-l-4 border-transparent hover:bg-gray-50 p-5 rounded-r-lg transition-all duration-300"
                    onclick="activateStep(5)">
                    <h3 class="font-semibold text-base text-lucid-900 mb-1 flex items-center gap-2">
                        <span
                            class="w-5 h-5 rounded-full bg-gray-200 text-gray-600 text-[10px] flex items-center justify-center font-bold">5</span>
                        Step 5: Verifiable Job Manifest
                    </h3>
                    <p class="text-xs text-gray-600 leading-relaxed">
                        Automatic generation of the "Flight Plan" (VJM) and proactive static analysis of Pytorch code
                        inside a TEE.
                    </p>
                </div>

                <div id="step-6-trigger"
                    class="step-card group cursor-pointer border-l-4 border-transparent hover:bg-gray-50 p-5 rounded-r-lg transition-all duration-300"
                    onclick="activateStep(6)">
                    <h3 class="font-semibold text-base text-lucid-900 mb-1 flex items-center gap-2">
                        <span
                            class="w-5 h-5 rounded-full bg-gray-200 text-gray-600 text-[10px] flex items-center justify-center font-bold">6</span>
                        Step 6: Runtime Verification
                    </h3>
                    <p class="text-xs text-gray-600 leading-relaxed">
                        Correlate physical evidence against the VJM, then automatically issue the cryptographic receipt
                        upon success.
                    </p>
                </div>

            </div>

            <div class="lg:col-span-8">
                <div
                    class="bg-lucid-900 rounded-xl shadow-2xl overflow-hidden flex flex-col h-[640px] border border-gray-700 relative">

                    <div class="bg-gray-800 px-4 py-3 flex items-center gap-2 border-b border-gray-700 shrink-0">
                        <div class="w-3 h-3 rounded-full bg-red-500"></div>
                        <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                        <div class="w-3 h-3 rounded-full bg-green-500"></div>
                        <div class="ml-4 text-xs text-gray-400 font-mono">assurance-runtime@verifiable-cloud:~</div>
                    </div>

                    <div class="flex-1 overflow-y-auto p-6 font-mono text-sm terminal-scroll relative"
                        id="terminal-content">

                        <div id="step-content-container" class="space-y-4">
                        </div>

                    </div>

                    <div class="absolute bottom-6 right-6">
                        <button id="next-btn" onclick="nextStep()"
                            class="bg-white text-lucid-900 hover:bg-gray-100 px-6 py-2 rounded-full font-bold shadow-lg transition-all flex items-center gap-2 transform hover:scale-105 active:scale-95">
                            Start Scan
                            <span>→</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div id="pillars" class="mt-24 pt-16 border-t border-gray-200">
            <div class="mb-12">
                <h2 class="text-3xl font-bold text-lucid-900 mb-4 tracking-tight">The Three Pillars of Verifiable AI
                </h2>
                <p class="text-gray-600 max-w-3xl">
                    Our architecture establishes a mathematical chain of custody across every layer of the stack,
                    relying on three independent planes of verification.
                </p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Pillar 1 -->
                <div class="bg-white p-6 rounded-xl border border-gray-200 shadow-sm flex flex-col">
                    <div class="mb-4">
                        <span
                            class="px-2 py-1 rounded text-[10px] font-bold bg-red-100 text-red-600 uppercase tracking-wider">Pillar
                            1</span>
                    </div>
                    <h3 class="font-bold text-lucid-900 mb-3 flex items-center gap-2">
                        The Assurance Plane
                    </h3>
                    <p class="text-xs text-gray-600 mb-6 leading-relaxed">
                        <strong>The "Hardware Truth"</strong>: Anchored in raw silicon. The DC-SCM acts as a
                        tamper-proof "inspector," attesting firmware integrity and generating signed telemetry for
                        physical parameters like real-time GPU power draw.
                    </p>
                    <div class="chart-container mt-auto">
                        <canvas id="flopsChart"></canvas>
                    </div>
                </div>

                <!-- Pillar 2 -->
                <div class="bg-white p-6 rounded-xl border border-gray-200 shadow-sm flex flex-col">
                    <div class="mb-4">
                        <span
                            class="px-2 py-1 rounded text-[10px] font-bold bg-blue-100 text-blue-600 uppercase tracking-wider">Pillar
                            2</span>
                    </div>
                    <h3 class="font-bold text-lucid-900 mb-3 flex items-center gap-2">
                        The Network Plane
                    </h3>
                    <p class="text-xs text-gray-600 mb-6 leading-relaxed">
                        <strong>The "Network Truth"</strong>: The "FlexNIC" acts as an independent "detective" in
                        "shadow mode," passively observing traffic without latency. It logs the communication truth:
                        "Who is this server actually talking to?"
                    </p>
                    <div class="chart-container mt-auto">
                        <canvas id="trafficChart"></canvas>
                    </div>
                </div>

                <!-- Pillar 3 -->
                <div class="bg-white p-6 rounded-xl border border-gray-200 shadow-sm flex flex-col">
                    <div class="mb-4">
                        <span
                            class="px-2 py-1 rounded text-[10px] font-bold bg-purple-100 text-purple-600 uppercase tracking-wider">Pillar
                            3</span>
                    </div>
                    <h3 class="font-bold text-lucid-900 mb-3 flex items-center gap-2">
                        The Software Plane
                    </h3>
                    <p class="text-xs text-gray-600 mb-6 leading-relaxed">
                        <strong>The "Flight Plan"</strong>: The Verifiable Job Manifest (VJM) is a prior declaration of
                        intent. It binds Job #501 to specific models, datasets, and resource constraints (e.g., "Only
                        talk to Internal Logging").
                    </p>
                    <div class="chart-container mt-auto">
                        <canvas id="vjmChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

    </main>

    <footer class="bg-lucid-900 text-white py-12 mt-24">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8 mb-12">
                <div class="col-span-2">
                    <div class="flex items-center gap-2 mb-4">
                        <div class="w-6 h-6 bg-white rounded flex items-center justify-center">
                            <span class="text-lucid-900 font-bold text-sm">L</span>
                        </div>
                        <span class="text-lg font-bold tracking-tight pt-0.5">LUCID</span>
                    </div>
                    <p class="text-gray-400 text-sm max-w-xs leading-relaxed">
                        Building the hardware and software foundations for verifiable AI.
                        Based in London & San Francisco.
                    </p>
                </div>
                <div>
                    <h4 class="font-bold text-sm mb-4 uppercase tracking-widest text-gray-500">Product</h4>
                    <ul class="space-y-2 text-sm text-gray-400">
                        <li><a href="#" class="hover:text-white transition-colors">Assurance Runtime</a></li>
                        <li><a href="#" class="hover:text-white transition-colors">Sovereign Sidecar</a></li>
                        <li><a href="#" class="hover:text-white transition-colors">FlexNIC P4</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-bold text-sm mb-4 uppercase tracking-widest text-gray-500">Legal</h4>
                    <ul class="space-y-2 text-sm text-gray-400">
                        <li><a href="#" class="hover:text-white transition-colors">License Agreement</a></li>
                        <li><a href="#" class="hover:text-white transition-colors">Attestations</a></li>
                        <li><a href="#" class="hover:text-white transition-colors">Security Repo</a></li>
                    </ul>
                </div>
            </div>
            <div class="border-t border-gray-800 pt-8 text-center text-xs text-gray-500 font-mono">
                &copy; 2025 Lucid Computing Inc.
            </div>
        </div>
    </footer>

    <script>
        let currentStep = 1;
        const totalSteps = 6;

        // --- Data & Content ---
        const stepContent = {
            1: {
                title: "Step 1: Install Lucid CLI",
                buttonText: "Install CLI",
                terminalHTML: `
                    <div class="text-gray-400 mb-2"># Step 1: Install Lucid Verification CLI</div>
                    <div class="flex items-center gap-2">
                        <span class="text-purple-400">➜</span>
                        <span class="text-white">curl -fsSL https://get.lucid.sh | bash</span>
                    </div>
                `,
                successHTML: `
                    <div class="mt-2 text-gray-300">Downloading lucid-v2.1.0-linux-amd64...</div>
                    <div class="w-full bg-gray-700 h-1 mt-1 rounded"><div class="bg-purple-500 h-1 rounded" style="width: 100%"></div></div>
                    <div class="mt-2 text-green-400">✔ Installed to /usr/local/bin/lucid</div>
                    <div class="mt-1 text-gray-400">Running initial hardware scan...</div>
                    <div class="mt-2 text-gray-300">Scanning 1,024 Nodes...</div>
                    <div class="mt-1 text-gray-300">Detecting Hardware Components...</div>
                    <div class="mt-2 text-green-400">✔ Found: 1,024 DC-SCM (Secure Control Modules)</div>
                    <div class="mt-1 text-green-400">✔ Found: 1,024 Programmable SmartNICs (FlexNIC)</div>
                    <div class="mt-2 text-gray-400">Retrofit status: COMPLETE</div>
                    <div class="text-xs text-gray-500">Hardware Inspectors Ready.</div>
                `
            },
            2: {
                title: "Step 2: Hardware Scan",
                buttonText: "Scan Hardware",
                terminalHTML: `
                    <div class="text-gray-400 mb-2"># Step 2: Discover architecture and find CC-enabled GPUs</div>
                    <div class="flex items-center gap-2">
                        <span class="text-purple-400">➜</span>
                        <span class="text-white">lucid hardware scan</span>
                    </div>
                `,
                successHTML: `
                    <div class="mt-2 text-gray-300">Scanning cluster nodes...</div>
                    <div class="mt-1 text-gray-300">Found 8,192 total GPUs in the cluster.</div>
                    <div class="grid grid-cols-[140px_1fr] gap-1 mt-2 text-sm">
                        <div class="text-gray-500">CC-enabled:</div><div class="text-green-400">8,180 / 8,192</div>
                        <div class="text-gray-500">Non CC-enabled:</div><div class="text-red-500 font-bold">12</div>
                    </div>
                    <div class="mt-4 text-gray-400">Listing Cluster Assets (Snippet):</div>
                    <div class="text-xs text-gray-500 grid grid-cols-4 gap-2 mt-1">
                        <div>GPU-0000: CC</div><div>GPU-0001: CC</div><div>GPU-0002: CC</div><div>GPU-0000: CC</div>
                        <div>GPU-1234: CC</div><div>GPU-5678: CC</div><div>GPU-8191: CC</div><div class="text-red-400 animate-pulse">GPU-0042: !CC</div>
                    </div>
                    <div class="mt-2 text-gray-500 text-[10px]">Total hardware mapped in 14.2s.</div>
                `
            },
            3: {
                title: "Step 3: Hardware Doctor",
                buttonText: "Run Doctor",
                terminalHTML: `
                    <div class="text-gray-400 mb-2"># Step 3: Verify TEE hardware & configuration for a specific GPU</div>
                    <div class="flex items-center gap-2">
                        <span class="text-purple-400">➜</span>
                        <span class="text-white">lucid doctor --gpu GPU-0000</span>
                    </div>
                `,
                successHTML: `
                    <div class="mt-2 text-gray-300">Checking GPU-0000 for TEE capabilities...</div>
                    <div class="grid grid-cols-[140px_1fr] gap-1 mt-2 text-sm">
                        <div class="text-gray-500">Node ID:</div><div class="text-white">Node-12-Rack-04</div>
                        <div class="text-gray-500">IOMMU Status:</div><div class="text-green-400">Enabled</div>
                        <div class="text-gray-500">CC Mode:</div><div class="text-red-500 font-bold">DISABLED</div>
                    </div>
                `,
                promptHTML: `
                    <div class="mt-4 border-t border-gray-700 pt-2">
                         <div class="text-yellow-400">⚠ Confidential Computing is DISABLED on GPU-0000.</div>
                        <div class="text-white mt-1">? Synchronize CC Mode for this node? [Y/n] <span id="prompt-cursor" class="animate-pulse">_</span></div>
                    </div>
                `,
                resolutionHTML: `
                    <div class="mt-2 text-gray-400">➜ RPC: node-manager enable-cc --gpu=GPU-0000</div>
                    <div class="text-gray-400">Broadcasting TEE configuration to Node-12-Rack-04...</div>
                    <div class="mt-1 text-gray-400">Resetting GPU on target node... <span class="text-green-400">OK</span></div>
                    <div class="mt-2 text-green-400">✔ GPU-0000 TEE Environment Synchronized.</div>
                    <div class="text-gray-500 text-xs">GPU-0000 now reporting CC Mode: ACTIVE.</div>
                `
            },
            4: {
                title: "Step 4: Check Integrity",
                buttonText: "Verify Integrity",
                terminalHTML: `
                    <div class="text-gray-400 mb-2"># Step 4: Establish Foundation of Trust (SPDM)</div>
                    <div class="flex items-center gap-2">
                        <span class="text-purple-400">➜</span>
                        <span class="text-white">lucid integrity --verify-roots --protocol=spdm-1.2</span>
                    </div>
                `,
                successHTML: `
                    <div class="mt-2 text-blue-300">[Caliptra] I: Reading Fuses... UDS_SEED (Obfuscated)</div>
                    <div class="text-blue-300">[Caliptra] ✔ ROOT OF TRUST ESTABLISHED.</div>
                    
                    <div class="mt-2 text-gray-300">Initiating SPDM 1.2 Handshake (Slot 0 - GPU)...</div>
                    <div class="text-xs text-gray-500 pl-2">
                        <div>> GET_VERSION (0x84)</div>
                        <div>> GET_CAPABILITIES (0xE1) Flags={CERT, MEAS}</div>
                        <div>> NEGOTIATE_ALGORITHMS (0xE3) BaseHash=SHA_384</div>
                        <div>> GET_MEASUREMENTS (0xE0)</div>
                    </div>
                    
                    <div class="mt-2 text-gray-300">| Index 1 (FW): c9b2...1a (MATCH)</div>
                    <div class="text-green-400">✔ COMPONENT INTEGRITY VERIFIED: Slot 0 (GPU-0)</div>
                    <div class="text-green-400">✔ COMPONENT INTEGRITY VERIFIED: Slot 1 (GPU-1)</div>
                    <div class="text-gray-400 italic">... (1022 more)</div>
                    <div class="mt-4 text-center animate-fade-in delay-100">
                        <a href="#" class="text-purple-400 text-xs underline hover:text-purple-300 transition-colors">Download Certificate (.pem)</a>
                    </div>
                `
            },
            5: {
                title: "Step 5: Generate Verifiable Job Manifest (VJM)",
                buttonText: "Plan & Inspect",
                terminalHTML: `
                    <div class="text-gray-400 mb-2"># Step 5: Auto-generate VJM and run Static Analysis</div>
                    <div class="flex items-center gap-2">
                        <span class="text-purple-400">➜</span>
                        <span class="text-white">python train_aura70b.py --dry-run --verify-manifest</span>
                    </div>
                `,
                successHTML: `
                    <div class="mt-2 text-blue-300">[PyTorch Hook] Generating Verifiable Job Manifest...</div>
                    <div class="mt-2 text-gray-300">I: Sending VJM to Assurance Runtime (AR)...</div>
                    <div class="mt-2 text-yellow-400">I: Inspecting code in TEE...</div>
                    <div class="mt-1 pl-4 text-xs text-gray-400 border-l border-gray-600">
                        <div>Detected Architecture: "Transformer"</div>
                        <div>Detected Training Method: "Supervised Fine-Tuning"</div>
                    </div>
                    <div class="mt-2 text-green-400">✔ VJM SIGNED & APPROVED.</div>
                    <div class="text-green-400 mb-4">✔ POLICY CHECK PASSED. EXECUTION AUTHORIZED.</div>

                    <div class="bg-gray-700 rounded-lg p-4 shadow-lg border-l-4 border-purple-500 max-w-sm mx-auto font-mono text-xs animate-fade-in relative">
                        <div class="absolute top-0 right-0 p-2 opacity-10">
                            <svg width="60" height="60" viewBox="0 0 24 24" fill="currentColor"><path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zM6 20V4h7v5h5v11H6z"/></svg>
                        </div>
                        <div class="flex justify-between items-start mb-3 border-b border-gray-600 pb-2 relative z-10">
                            <div>
                                <h4 class="text-white font-bold text-sm">Verifiable Job Manifest</h4>
                                <div class="text-[10px] text-gray-400">Job ID: a1b2c3d4...</div>
                            </div>
                            <div class="text-purple-200 bg-purple-900/50 px-2 py-0.5 rounded text-[10px] font-bold uppercase border border-purple-500/30 shadow-[0_0_10px_rgba(168,85,247,0.2)]">Signed</div>
                        </div>
                        <div class="space-y-1.5 text-gray-300 relative z-10 font-mono text-[10px]">
                            <div class="flex justify-between items-center group">
                                <span class="text-gray-400">Principal Identity:</span>
                                <span class="text-purple-300" title="did:key:z6Mk...">did:key:z6Mk...</span>
                            </div>
                            <div class="flex justify-between items-center group">
                                <span class="text-gray-400">Compute Graph Hash:</span>
                                <span class="text-white" title="sha256-e3b0c442...">sha256-e3b0...</span>
                            </div>
                             <div class="flex justify-between items-center group">
                                <span class="text-gray-400">Dataset Identifier:</span>
                                <span class="text-white" title="sha256-abc...">sha256-abc... (EU-Corpus-v3)</span>
                            </div>
                            <div class="border-t border-gray-600 my-1 pt-1 opacity-50"></div>
                            <div class="flex justify-between items-center group">
                                <span class="text-gray-400">Resource Claims:</span>
                                <span class="text-white">1024x H100 (700W)</span>
                            </div>
                            <div class="flex justify-between items-center group">
                                <span class="text-gray-400">Est. Duration:</span>
                                <span class="text-white">240 Hours</span>
                            </div>
                            <div class="flex justify-between items-center group">
                                <span class="text-gray-400">Network Policy:</span>
                                <span class="text-red-300">Egress: Logging-Server Only</span>
                            </div>
                        </div>
                        <div class="mt-3 pt-2 border-t border-gray-600 text-[10px] text-gray-500 flex justify-between items-center relative z-10">
                            <span>VJM Version: 1.0</span>
                            <div class="w-8 h-2 bg-gray-600 rounded"></div>
                        </div>
                    </div>
                `
            },
            6: {
                title: "Step 6: Runtime Verification",
                buttonText: "Verify & Issue",
                terminalHTML: `
                    <div class="text-gray-400 mb-2"># Step 6: Runtime Correlation & Receipt Issuance</div>
                    <div class="flex items-center gap-2">
                        <span class="text-purple-400">➜</span>
                        <span class="text-white">lucid runtime-watch --duration=240h --issue-receipt</span>
                    </div>
                `,
                successHTML: `
                    <div class="mt-2 text-purple-300">[FlexNIC] P4Runtime WriteRequest:</div>
                    <div class="text-xs text-gray-500 pl-2">
                        <div>match: { ipv4.dst: 10.255.1.1 } action: permit</div>
                    </div>
                    <div class="text-green-400 mb-2">✔ Shadow Mode Active. Network Policy Enforced.</div>
                    
                    <div class="text-purple-300">[DC-SCM] PLDM Sensor Reading (Power):</div>
                    <div class="text-xs text-gray-500 pl-2">
                        <div>SensorID: 0x0008 | Reading: 702.5 Watts | Sig: Valid</div>
                    </div>
                    
                    <div class="text-green-400 mb-2">✔ Estimated Work: 1.1e25 FLOPs. Matches claim. Resource Policy verified.</div>

                    <div class="mt-4 border-t border-dashed border-gray-600 pt-4">
                        <div class="text-blue-300 font-bold mb-1">>> Correlation Successful. Generating Proof...</div>
                        
                        <div class="mt-4 bg-gray-700 rounded-lg p-4 shadow-lg border-l-4 border-green-500 max-sm mx-auto font-mono text-xs animate-fade-in relative">
                            <div class="absolute top-0 right-0 p-2 opacity-10">
                                <svg width="60" height="60" viewBox="0 0 24 24" fill="currentColor"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm-2 16l-4-4 1.41-1.41L10 14.17l6.59-6.59L18 9l-8 8z"/></svg>
                            </div>
                            <div class="flex justify-between items-start mb-3 border-b border-gray-600 pb-2 relative z-10">
                                <div>
                                    <h4 class="text-white font-bold text-sm">Verifiable Receipt</h4>
                                    <div class="text-[10px] text-gray-400">Job: a1b2c3d4...</div>
                                </div>
                                <div class="text-green-200 bg-green-900/50 px-2 py-0.5 rounded text-[10px] font-bold uppercase border border-green-500/30 shadow-[0_0_10px_rgba(34,197,94,0.2)]">Verified</div>
                            </div>
                            <div class="space-y-1.5 text-gray-300 relative z-10 font-mono text-[10px]">
                                <div class="flex justify-between items-center group">
                                    <span class="text-gray-400">Status:</span>
                                    <span class="text-green-400 font-bold">COMPLIANT</span>
                                </div>
                                <div class="flex justify-between items-center group">
                                    <span class="text-gray-400">Actual FLOPs:</span>
                                    <span class="text-white">1.1e25 (Match)</span>
                                </div>
                                <div class="flex justify-between items-center group">
                                    <span class="text-gray-400">Power Variance:</span>
                                    <span class="text-white">< 0.1% (Ideal)</span>
                                </div>
                                <div class="border-t border-gray-600 my-1 pt-1 opacity-50"></div>
                                <div class="flex justify-between items-center group">
                                    <span class="text-gray-400">Proof Signature:</span>
                                    <span class="text-purple-300" title="30450221...">30450221...</span>
                                </div>
                            </div>
                            <div class="mt-3 pt-2 border-t border-gray-600 text-[10px] text-gray-500 flex justify-between items-center relative z-10">
                                <span>Receipt Version: 1.0</span>
                                <div class="w-8 h-2 bg-gray-600 rounded"></div>
                            </div>
                        </div>

                        <div class="mt-4 text-center">
                            <div class="text-green-400 font-bold mb-2">COMPLIANCE RECORDED</div>
                            <a href="#" class="text-green-400 text-xs underline hover:text-green-300 transition-colors">Download Certificate (.pem)</a>
                        </div>
                    </div>
                `
            }
        };

        // --- Core Interaction Logic ---

        let stepPhase = 0; // 0: Start, 1: Prompted (Step 2 only), 2: Complete

        function activateStep(step) {
            currentStep = step;
            stepPhase = 0; // Reset
            renderSidebar();
            renderTerminal(step);
        }

        function nextStep() {
            const container = document.getElementById('step-content-container');
            const btn = document.getElementById('next-btn');
            const data = stepContent[currentStep];

            // --- Phase 2: Complete -> Advance to Next Step ---
            if (stepPhase === 2) {
                if (currentStep < totalSteps) {
                    currentStep++;
                    stepPhase = 0; // Reset for next step
                    renderSidebar();
                    renderTerminal(currentStep);
                }
                return;
            }

            // --- Step 3 Special Logic (Doctor w/ Interaction) ---
            if (currentStep === 3) {
                if (stepPhase === 0) {
                    btn.disabled = true;
                    btn.innerHTML = `<span class="animate-spin">⟳</span> Diagnosing...`;
                    btn.classList.add('opacity-75');

                    container.innerHTML = data.terminalHTML;

                    setTimeout(() => {
                        const successDiv = document.createElement('div');
                        successDiv.innerHTML = data.successHTML;
                        successDiv.classList.add('animate-fade-in');
                        container.appendChild(successDiv);

                        setTimeout(() => {
                            const promptDiv = document.createElement('div');
                            promptDiv.innerHTML = data.promptHTML;
                            container.appendChild(promptDiv);
                            document.getElementById('terminal-content').scrollTop = document.getElementById('terminal-content').scrollHeight;

                            stepPhase = 1;
                            btn.disabled = false;
                            btn.innerHTML = `Confirm (Y)`;
                            btn.classList.remove('opacity-75');
                            btn.classList.add('bg-purple-600', 'text-white', 'hover:bg-purple-500');
                            btn.classList.remove('bg-white', 'text-lucid-900');
                        }, 1000);

                    }, 1000);
                    return;
                } else if (stepPhase === 1) {
                    btn.disabled = true;
                    document.getElementById('prompt-cursor').innerText = 'Y';
                    document.getElementById('prompt-cursor').classList.remove('animate-pulse');

                    setTimeout(() => {
                        const resDiv = document.createElement('div');
                        resDiv.innerHTML = data.resolutionHTML;
                        resDiv.classList.add('animate-fade-in');
                        container.appendChild(resDiv);
                        document.getElementById('terminal-content').scrollTop = document.getElementById('terminal-content').scrollHeight;

                        setTimeout(() => {
                            stepPhase = 2;

                            const nextStepNum = currentStep + 1;
                            const nextStepName = stepContent[nextStepNum] ? stepContent[nextStepNum].title : "Finish";

                            btn.disabled = false;
                            btn.classList.remove('opacity-75', 'bg-purple-600', 'hover:bg-purple-500');
                            btn.classList.add('bg-white', 'text-lucid-900', 'hover:bg-gray-100');
                            btn.innerHTML = `Proceed to ${nextStepName} <span>→</span>`;
                        }, 2000);

                    }, 500);
                    return;
                }
            }
            // 1. Disable Button & Show Running State
            btn.disabled = true;
            btn.innerHTML = `<span class="animate-spin">⟳</span> Processing...`;
            btn.classList.add('opacity-75');

            // 2. Simulate Typing the Command
            container.innerHTML = data.terminalHTML;

            // 3. Wait, then show success, then prepare for advancement
            setTimeout(() => {
                // Append Success HTML
                const successDiv = document.createElement('div');
                successDiv.innerHTML = data.successHTML;
                successDiv.classList.add('animate-fade-in');
                container.appendChild(successDiv);

                // Auto Scroll
                const termContent = document.getElementById('terminal-content');
                termContent.scrollTop = termContent.scrollHeight;

                // 4. Transition to Complete State
                setTimeout(() => {
                    if (currentStep < totalSteps) {
                        stepPhase = 2; // Mark as ready to proceed

                        const nextStepNum = currentStep + 1;
                        const nextStepName = stepContent[nextStepNum].title;

                        btn.disabled = false;
                        btn.classList.remove('opacity-75');
                        btn.innerHTML = `Proceed to Next Step <span>→</span>`;
                        btn.classList.add('ring-2', 'ring-lucid-accent', 'ring-offset-2', 'ring-offset-lucid-900');

                    } else {
                        // Finished
                        btn.innerHTML = "Lifecycle Complete";
                        btn.classList.remove('bg-white', 'text-lucid-900');
                        btn.classList.add('bg-green-500', 'text-white');
                    }
                }, 1500);

            }, 1000);
        }

        function renderSidebar() {
            for (let i = 1; i <= totalSteps; i++) {
                const el = document.getElementById(`step-${i}-trigger`);
                if (el) {
                    if (i === currentStep) {
                        el.className = "step-card group cursor-pointer border-l-4 border-lucid-accent bg-purple-50 p-5 rounded-r-lg transition-all duration-300";
                    } else if (i < currentStep) {
                        el.className = "step-card group cursor-pointer border-l-4 border-green-500 bg-green-50/30 p-5 rounded-r-lg transition-all duration-300 opacity-70 hover:opacity-100";
                    } else {
                        el.className = "step-card group cursor-pointer border-l-4 border-transparent hover:bg-gray-50 p-5 rounded-r-lg transition-all duration-300 opacity-60";
                    }
                }
            }
        }

        function renderTerminal(step) {
            const container = document.getElementById('step-content-container');
            const btn = document.getElementById('next-btn');
            const data = stepContent[step];

            container.innerHTML = data.terminalHTML;
            btn.innerHTML = `${data.buttonText} <span>→</span>`;
            btn.disabled = false;
            btn.classList.remove('opacity-75', 'bg-green-500', 'text-white', 'bg-purple-600');
            btn.classList.add('bg-white', 'text-lucid-900');
        }

        function scrollToGuide() {
            const el = document.getElementById('guide-section');
            if (el) el.scrollIntoView({ behavior: 'smooth' });
        }

        // --- Chart.js Implementations ---
        function initCharts() {
            const elFlops = document.getElementById('flopsChart');
            const elTraffic = document.getElementById('trafficChart');
            const elVjm = document.getElementById('vjmChart');
            if (!elFlops || !elTraffic || !elVjm) return;

            // 1. FLOPs vs Power (Line Chart)
            const ctxFlops = elFlops.getContext('2d');
            new Chart(ctxFlops, {
                type: 'line',
                data: {
                    labels: ['00:00', '04:00', '08:00', '12:00', '16:00', '20:00', '24:00'],
                    datasets: [
                        {
                            label: 'Power Draw (W)',
                            data: [300, 450, 700, 702.5, 710, 680, 500],
                            borderColor: '#ef4444',
                            yAxisID: 'y',
                            tension: 0.4,
                            borderWidth: 2,
                            pointRadius: 0
                        },
                        {
                            label: 'Verified FLOPs',
                            data: [0.4, 0.6, 1.1, 1.15, 1.1, 1.0, 0.8],
                            borderColor: '#7c3aed',
                            yAxisID: 'y1',
                            tension: 0.4,
                            borderDash: [5, 5],
                            borderWidth: 2,
                            pointRadius: 0
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        y: { display: false },
                        y1: { display: false },
                        x: { grid: { display: false }, ticks: { font: { size: 10 } } }
                    }
                }
            });

            // 2. Traffic Flow (Doughnut)
            const ctxTraffic = elTraffic.getContext('2d');
            new Chart(ctxTraffic, {
                type: 'doughnut',
                data: {
                    labels: ['Internal', 'Egress', 'Blocked'],
                    datasets: [{
                        data: [85, 14, 1],
                        backgroundColor: ['#10b981', '#3b82f6', '#ef4444'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '70%',
                    plugins: { legend: { display: false } }
                }
            });

            // 3. VJM Policy Compliance (Horizontal Bar)
            const ctxVjm = elVjm.getContext('2d');
            new Chart(ctxVjm, {
                type: 'bar',
                data: {
                    labels: ['Model X', 'Dataset Y', 'GPU Limit', 'Net Policy'],
                    datasets: [{
                        label: 'Match Confidence',
                        data: [100, 100, 100, 100],
                        backgroundColor: '#7c3aed',
                        borderRadius: 4,
                        barThickness: 12
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: { display: false, max: 100 },
                        y: {
                            grid: { display: false },
                            ticks: { font: { size: 10, family: 'Space Mono' } }
                        }
                    }
                }
            });
        }

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            renderSidebar();
            renderTerminal(1);
            initCharts();
        });
    </script>
</body>

</html>